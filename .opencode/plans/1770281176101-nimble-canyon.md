# Plan: Fix API Key + Remove Fallbacks

## Overview
Fix the GEMINI_API_KEY not being recognized and remove silent fallback behavior - return proper errors to users instead.

## Changes Required

### 1. Fix API Key Issue
The `@ai-sdk/google` provider expects `GOOGLE_GENERATIVE_AI_API_KEY` by default. Since we renamed to `GEMINI_API_KEY`, we must pass it explicitly to ALL google() calls.

**File**: `packages/api/src/ai-creative.ts`

The `model()` function already passes apiKey, but it can be undefined. We need to:
- Throw an error early if `GEMINI_API_KEY` is not set
- Remove all fallback/catch blocks that silently return fallback data

### 2. Remove Fallback Behavior

**parseBriefWithAi** (lines 84-118):
- Remove the catch block that returns `buildBriefJsonFromInput` fallback
- Let errors propagate or throw a proper error

**generateCreativeWithAi** (lines 178-242):
- Remove the catch block that returns `buildCreativeFallback`
- Remove `buildCreativeFallback` function entirely
- Remove `PLACEHOLDER_IMAGE_DATA_URL` constant
- Let errors propagate with proper messages

**generateImageWithGeminiFlash** (lines 37-82):
- Instead of returning `null` on error, throw the error
- Remove early return for missing API key, throw instead

### 3. Update API Routes to Handle Errors

**File**: `packages/api/src/app.ts`

Update the route handlers to catch errors and return proper HTTP error responses with meaningful messages.

### 4. Update Tests

**File**: `packages/api/src/ai-routes.test.ts`

- Remove tests for fallback behavior
- Add tests that verify proper error responses when AI fails

## Files to Modify
1. `packages/api/src/ai-creative.ts` - Remove fallbacks, throw errors
2. `packages/api/src/app.ts` - Add error handling in routes
3. `packages/api/src/ai-routes.test.ts` - Update tests for new error behavior

## Verification
1. Run `bun test` in packages/api
2. Start API without GEMINI_API_KEY - should get clear error
3. Start API with GEMINI_API_KEY - should work normally
